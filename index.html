<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Basket Mini — Pro Look</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f17; --bg2:#131b2b;
      --card:#0f1420; --card2:#121a2a;
      --text:#eaf0ff; --muted:#97a3be;
      --accent:#ffc857; --good:#2dd4bf; --warn:#ff6b6b; --ring:#ffffff22;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:radial-gradient(1200px 600px at 50% -10%, #1c2740 0%, #0b0f17 55%);color:var(--text);font-family:"Cairo",system-ui;}
    .wrap{max-width:480px;margin:0 auto;padding:16px}

    /* Top stats */
    .grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .badge{background:linear-gradient(180deg,var(--card),var(--card2));border-radius:18px;padding:12px 14px;box-shadow:0 8px 24px #0008, inset 0 1px 0 var(--ring)}
    .k{font-size:13px;color:var(--muted)}
    .v{font-weight:800;font-size:22px;letter-spacing:.2px}

    /* Arena / stadium */
    .arena{
      position:relative;height:420px;margin:14px 0 10px;border-radius:22px;
      background:
        radial-gradient(160px 60px at 50% 40px, #fff3 0, #fff0 60%),
        radial-gradient(900px 320px at 50% 0%, #1b2540 0%, #0e1422 45%, #0a0f18 70%),
        linear-gradient(180deg, #0a0f18 0%, #0a0f18 100%);
      box-shadow:0 20px 60px #000a, inset 0 0 0 1px var(--ring);
      overflow:hidden;
    }
    /* floor */
    .floor{
      position:absolute;left:0;right:0;bottom:-40px;height:220px;
      background:
        radial-gradient(600px 200px at 50% 0, #1b2235 0%, #0f1627 70%, transparent 71%),
        radial-gradient(1400px 220px at 50% 0, #0c111b 0%, #0c111b 65%, transparent 66%);
      filter:blur(0.2px);
    }
    /* hoop (SVG) */
    .hoop{
      position:absolute;top:78px;left:50%;transform:translateX(-50%);
      width:220px;height:180px;
    }
    svg{display:block;width:100%;height:100%}
    .net-glow{opacity:0;transition:.25s ease}

    /* ball */
    .ball{
      position:absolute;bottom:28px;left:50%;transform:translateX(-50%);
      width:90px;height:90px;border-radius:50%;
      background:
        radial-gradient(38px 38px at 32% 32%, #ffa86a 0%, #ff7f36 45%, transparent 46%),
        radial-gradient(120px 120px at 70% 70%, #f25f1a 0%, #c6460c 70%);
      box-shadow:0 14px 30px #000c, inset -8px -8px 16px #0003;
    }
    .ball.shoot{animation:shoot .95s cubic-bezier(.2,.65,.2,1) forwards}
    @keyframes shoot{
      0%  { transform:translateX(-50%) translateY(0) scale(1) }
      45% { transform:translateX(-50%) translateY(-250px) scale(.96) }
      100%{ transform:translateX(-50%) translateY(-150px) scale(.91) }
    }

    /* CTA */
    .btn{
      width:100%;border:0;background:linear-gradient(180deg,#ffd46a,#ffb724);
      color:#1b1100;font-weight:800;font-size:18px;border-radius:16px;padding:14px 16px;
      box-shadow:0 10px 20px #0008, inset 0 1px 0 #fff7;
      transition:.15s transform ease;cursor:pointer
    }
    .btn:active{transform:translateY(1px)}
    .hint{color:var(--muted);text-align:center;font-size:12px;margin-top:8px}

    /* overlay */
    .overlay{position:absolute;inset:0;display:none;place-items:center;background:#0007;backdrop-filter:blur(2px)}
    .panel{background:linear-gradient(180deg,#121a2a,#0f1420);border-radius:20px;padding:18px 16px;box-shadow:0 16px 40px #000c;min-width:72%}
    .panel h3{margin:0 0 8px 0}
    .row{display:flex;gap:10px;margin-top:10px}
    .btn2{flex:1;border:0;border-radius:14px;padding:12px 14px;font-weight:800}
    .go{background:#111;color:#fff}
    .reward{background:#13322d;color:#c7fff5;border:1px solid #2dd4bf55}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="grid3">
      <div class="badge"><div class="k">المستوى</div><div class="v" id="level">1</div></div>
      <div class="badge"><div class="k">السكور</div><div class="v" id="score">0</div></div>
      <div class="badge"><div class="k">المحاولات</div><div class="v" id="lives">3</div></div>
    </div>

    <div class="arena" id="arena">
      <!-- stadium floor glow -->
      <div class="floor"></div>

      <!-- Hoop SVG (إطار + شبكة) -->
      <div class="hoop">
        <svg viewBox="0 0 220 180" xmlns="http://www.w3.org/2000/svg">
          <!-- backboard -->
          <rect x="25" y="0" width="170" height="18" rx="9" fill="#ffffffcc"/>
          <!-- rim -->
          <path d="M40 80 Q110 105 180 80" fill="none" stroke="#ff7a3c" stroke-width="10" stroke-linecap="round"/>
          <!-- net -->
          <path id="net" d="M55 85 L165 85 L150 140 L70 140 Z"
                fill="url(#mesh)" stroke="#ff7a3c" stroke-width="6" stroke-linejoin="round"/>
          <!-- glow on success -->
          <g class="net-glow">
            <defs>
              <radialGradient id="g" cx="50%" cy="50%" r="60%">
                <stop offset="0%" stop-color="#ff934e" stop-opacity="1"/>
                <stop offset="100%" stop-color="#ff934e" stop-opacity="0"/>
              </radialGradient>
            </defs>
            <ellipse cx="110" cy="115" rx="72" ry="34" fill="url(#g)"/>
          </g>
          <defs>
            <!-- subtle mesh pattern -->
            <pattern id="mesh" width="10" height="10" patternUnits="userSpaceOnUse">
              <path d="M0 10 L10 0 M-2 2 L2 -2 M8 12 L12 8" stroke="#ffffff30" stroke-width="1"/>
            </pattern>
          </defs>
        </svg>
      </div>

      <!-- Ball -->
      <div class="ball" id="ball"></div>

      <!-- overlay -->
      <div class="overlay" id="overlay">
        <div class="panel">
          <h3 id="ovTitle">انتهت المحاولات</h3>
          <div style="color:var(--muted);font-size:14px" id="ovText">شاهد إعلان مكافأة للمتابعة؟</div>
          <div class="row">
            <button class="btn2 reward" id="continueBtn">متابعة (إعلان)</button>
            <button class="btn2 go" id="restartBtn">إعادة</button>
          </div>
        </div>
      </div>
    </div>

    <button class="btn" id="shootBtn">تصويب 🏀</button>
    <div class="hint">احتمال النجاح يصعب تدريجيًا مع المراحل. كل مستوى يحتاج عدد إصابات أكثر.</div>
  </div>

<script>
  // Telegram theming (اختياري)
  const tg = window.Telegram?.WebApp; if(tg){ tg.ready(); tg.expand(); }

  const $ = id => document.getElementById(id);
  const levelEl=$('level'), scoreEl=$('score'), livesEl=$('lives');
  const ball=$('ball'), shootBtn=$('shootBtn');
  const overlay=$('overlay'), continueBtn=$('continueBtn'), restartBtn=$('restartBtn');
  const netGlow = document.querySelector('.net-glow');

  let level=1, score=0, lives=3, target=3;

  function render(){
    levelEl.textContent=level;
    scoreEl.textContent=score;
    livesEl.textContent=lives;
  }
  render();

  function successAnim(){
    netGlow.style.opacity=1;
    setTimeout(()=> netGlow.style.opacity=0, 250);
  }

  function nextLevel(){
    level++; target+=2;
    // مكان إعلان بين المراحل (Interstitial)
    if(window.SAD){ SAD.showInterstitialAd({blockId:'YOUR_INTERSTITIAL_BLOCK_ID'}).catch(()=>{}); }
    render();
  }

  function fail(){
    lives--; render();
    if(lives<=0){ showOverlay('انتهت المحاولات','شاهد إعلان مكافأة للحصول على محاولة إضافية؟'); }
  }

  function rng(){ return Math.random(); }

  function shoot(){
    ball.classList.remove('shoot'); void ball.offsetWidth; ball.classList.add('shoot');
    const success = rng() < Math.max(0.18, 0.78 - (level-1)*0.08); // يبدأ سهل ويصعب تدريجيًا
    setTimeout(()=>{
      if(success){
        successAnim();
        score++;
        render();
        if(score % target === 0){ nextLevel(); }
      }else{
        fail();
      }
    }, 620);
  }

  shootBtn.onclick=shoot;

  function showOverlay(t,sub){ $('ovTitle').textContent=t; $('ovText').textContent=sub; overlay.style.display='grid'; }
  function hideOverlay(){ overlay.style.display='none'; }

  continueBtn.onclick=()=>{
    if(window.SAD){
      SAD.showRewardedAd({blockId:'YOUR_REWARDED_BLOCK_ID'})
        .then(()=>{ lives=1; hideOverlay(); render(); })
        .catch(()=>{});
    }else{
      lives=1; hideOverlay(); render();
    }
  };
  restartBtn.onclick=()=>{ level=1; score=0; lives=3; target=3; hideOverlay(); render(); };
</script>
</body>
</html>
